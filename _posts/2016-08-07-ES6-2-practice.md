---
title: ES6实践（二）
layout: post
tag:
- JavaScript

categories:
- tech

excerpt: 学习过ES6有一段时间了，新语法很多，记不牢，故编写该文章，主要整理下ES6中一些实战中比较有用的例子。这是该系列的第二篇。
---

## 函数的扩展

ES6对函数进行了扩展，新的函数支持定义默认值、扩展运算符、写法更加简洁的箭头函数等。

### 函数参数的默认值（3种形式）

**函数默认值**

{% highlight javascript %}
let fn = function(x = 1, y = 2) {
    return x + y;
}
fn(); // 3

// 代替函数体内判断的写法
let fn = function(x, y) {
    x = x || 1;
    y = y || 2;
    return x + y;
}
fn(); // 3
{% endhighlight %}

**函数默认值——解构参数**

可以通过解构变量来定义函数参数的默认值，减少参数的个数

{% highlight javascript %}
let fn = function({x = 1, y = 2}) {
    return x + y;
}
fn(); // 3
{% endhighlight %}

**函数默认值与解构赋值结合**

注意：前面这两种方法都存在一个问题，如果只使用第二个参数，就必须给第一个参数传入`undefined`来指示第一个参数的默认值，通过解构赋值和函数默认值结合的形式可以避免这样的问题。

{% highlight javascript %}
// 既可以不传入参数，也可以指定参数调用
let fn = function({x = 1, y = 2} = {}) {
    return x + y;
}
fn({y: 2}); // 3
{% endhighlight %}

实例：默认参数与解构赋值混合使用

{% highlight javascript %}
let fn = function(x = 1, {y = 2, z = 3} = {}) {
    return x + y + z;
}
fn(5); // 10
{% endhighlight %}

## rest参数与拓展符

ES6也支持了函数rest形式的参数（使用者不需要考虑参数的个数），rest参数必须跟在函数最后面，实例如下：

{% highlight javascript %}
let fn = function(...values) {
    return values.join(' ');
}
fn('hello', 'i\'m', 'waynezheng'); // hello i'm waynezheng
{% endhighlight %}

### 扩展运算符的灵活运用

{% highlight javascript %}
// 数组合并
let arr = [...[1, 2, 3], ...[4, 5, 6]]; // [1, 2, 3, 4, 5, 6]

// 拆分字符串
let str = [...'hello']; // ['h', 'e', 'l', 'l', 'o']
{% endhighlight %}

注意：实现了`iterator`接口的对象，都可以实用扩展运算符进行解构。

## 箭头函数

ES6引入的箭头函数，使函数的定义方式更加简洁，同时也解决了`this`绑定的问题。

### 基本用法

{% highlight javascript %}
let fn = x => x;

// 等价于
let fn = function(x) {
    return x;
}
{% endhighlight %}

**解决`this`指向的问题**

{% highlight javascript %}
let fn = function() {
    this.name = 'fn';

    setTimeout(() => {
        console.log(this.name); // fn
    }, 1000);
};
fn();

// 代替用that赋值this
let fn = function() {
    let that = this;

    setTimeout(function() {
        this.name = 'fn';
        console.log(this.name); // undefined
        console.log(that.name); // fn
    }, 1000);
}
fn();
{% endhighlight %}

